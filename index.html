<html>
	<head>
		<title>Wild Driver - Alpha 1.20</title>
		<link type="text/css" href="css/space-madness.css" rel="stylesheet" />
		<link type="text/css" href="css/ui-darkness/jquery-ui-1.8.13.custom.css" rel="stylesheet" />
		<script type="application/javascript" src="js/jquery-1.5.1.min.js"></script>
		<script type="application/javascript" src="js/jquery-ui-1.8.13.custom.min.js"></script>
		<script type="application/javascript" src="js/jquery.spritely-0.5.js"></script>
		<script type="application/javascript" src="js/car-bot.js"></script>
		<script type="application/javascript" src="js/car.js"></script>
		<script type="application/javascript" src="js/circuit.js"></script>
		<script type="application/javascript" src="js/event.js"></script>
		<script type="application/javascript" src="js/motionEngine.js"></script>
		<script type="application/javascript" src="js/border.js"></script>
		<script type="application/javascript">
		
			// keyconfs
			var keyConf1 = {
				up : 'arrow-up',
				down : 'arrow-down',
				left : 'arrow-left',
				right : 'arrow-right'
			};

			var botConf = {
				posX : 500,
				posY : 200,
				vel : 1
			};
		
		
			function addPoints(angle, vel) {
				updatePointsBoard(angle, vel);
			}

			var addPointer = addPoints;
			
			var motionEngine = new motionEngine(addPointer);
			var motionEngineRunning = false;
			var motionEnginePaused = false;
			var points = 0;
			
			//***************************************
			// Agrego objectos al motor de movimiento
			motionEngine.addObject(new car(1, 450, 200, addPointer, keyConf1, motionEngine));
			motionEngine.addObject(new carBot(2, botConf, addPointer, motionEngine));

			var circuit = new circuit();
			motionEngine.addObject(circuit);

			for(var i = 0; i < circuit.borders.length; i++) {
				motionEngine.addObject(circuit.borders[i]);
			}
			//****************************************
			

			$(document).ready(function() {
				$("button").button();
			});
			
			function updatePointsBoard(points, vel) {
				$("#points").text(points);
				$("#vel").text(vel);
			}

			

			/** captura de eventos del teclado **/
			$(document).keydown(function(e) {
				if(motionEngineRunning) {
					var mkey = motionEngine.getMapped(e.keyCode);
					motionEngine.pushEvent(new event('keyboard', { "keycode": mkey } ));
				}
			});
			$(document).keyup(function(e) {
				if(motionEngineRunning) {
					var mkey = motionEngine.getMapped(e.keyCode);
					motionEngine.pushEvent(new event('keyboard', { "keyup": mkey } ));
				}
			});
			
			
			
			function startGame() {
				if(!motionEngineRunning) {
					motionEngineRunning = true;
					motionEngine.init();

				} else {
					motionEngine.startLoop();
				}
			}

			function pauseGame() {
				motionEngine.stop();
			}

			function motionEngineOver() {
				$("#pointsToUser").html(points);
				$("#game-over").dialog({
					modal : true,
					title : 'Game over',
					buttons : {
						"Ok" : function() {
							rankUser();
						}
					}
				});
			}

			
		</script>
	</head>
	<body style="background-color: white; text-align:center;font-family:arial;" >
		<div style="width: 1015px; height: 570;margin-left: auto; margin-right: auto;">
			<!-- left side panel -->
			<div class="panel-left">
				<button onclick="window.location = '../../index.html'" style="width: 100%;">
					Home
				</button>
				<button onclick="window.location = 'ranking.php'" style="width: 100%;">
					Ranking
				</button>
				<br/>
				<div class="commands">
					<div style="font-weight: bold;">
						Key Commands
					</div>
					<div>
						<a style="float: left;">Movements</a><a style="float: right;">arrows</a>
					</div>
					<div>
						<a style="float: left;">Weapon fire</a><a style="float: right;">F</a>
					</div>
				</div>
			</div>
			<!-- center side panel -->
			<div style="float: left; margin-left: auto; margin-right: auto; width: 708px; height: 570; position: relative; left: 0;">
				<div class="header-layer">
					Wild Driver
				</div>
				<div id="container"></div>
				<canvas id="canvas-layer" width="708" height="570px"></canvas>
			</div>
			<!-- right side panel -->
			<div id="right-side-panel" style="float: left; width: 150px; height: 570;">
				<button onclick="startGame();return false;" style="width: 100%;">
					Start
				</button>
				<button onclick="pauseGame();return false;" style="width: 100%;">
					Pause
				</button>
				<button id="restartBtn" onclick="window.location = 'index.html'" style="width: 100%;">
					Refresh
				</button>
				<span>Angle:&nbsp;&nbsp;</span><span id="points">0</span>
				<span>Speed:&nbsp;</span><span id="vel">0</span>
			</div>
		</div>
		<br/>
		<div id="game-over" style="display:none;">
			You've been killed by an asteroid!
			<div id="pointsToUser">
				Your score:
			</div>
			<div>
				<label>Enter your name:</label>
				<input id="username" type="text" maxlength="10" size="15" value=""/>
			</div>
		</div>
		<div id="showRanking" style="display:none;"></div>
		<div style="width: 100%;color: white;">
			By Juan Manuel Agï¿½ero - 2011
		</div>
	</body>
</html>
